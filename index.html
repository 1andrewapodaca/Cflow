<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Certatude Call Flow Coach</title>
  <style>
    * { box-sizing: border-box; }
    :root {
      --bg: #F3F4F6;
      --bg-elevated: #FFFFFF;
      --border-subtle: #E5E7EB;
      --border-strong: #D1D5DB;
      --text-main: #4D5859;
      --text-muted: #6B7280;
      --accent: #2F318D;
      --accent-soft: #9747FF;
      --accent-warm: #CE9F3F;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }
    .app {
      max-width: 1000px;
      margin: 0 auto;
      padding: 16px;
    }
    header {
      padding-bottom: 8px;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--border-subtle);
    }
    header h1 {
      margin: 0 0 4px;
      font-size: 1.25rem;
      letter-spacing: 0.01em;
      color: var(--accent);
    }
    header p {
      margin: 0;
      font-size: 0.8rem;
      color: var(--text-muted);
      font-style: italic;
    }

    /* Top tabs */
    .tabs {
      display: flex;
      gap: 6px;
      margin-bottom: 6px;
      flex-wrap: wrap;
    }
    .tab {
      flex: 0 0 auto;
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid var(--border-strong);
      background: #F9FAFB;
      color: var(--text-main);
      font-size: 0.8rem;
      cursor: pointer;
    }
    .tab.active {
      background: var(--accent);
      color: #FFFFFF;
      border-color: var(--accent-warm);
      box-shadow: 0 0 0 1px rgba(206,159,63,0.35);
    }

    /* Timer bar */
    .timer-bar {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 10px;
      font-size: 0.8rem;
    }
    .timer {
      font-size: 0.8rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .timer-display {
      font-family: "SF Mono", ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.9rem;
      color: var(--text-main);
    }
    .timer button {
      border-radius: 999px;
      border: 1px solid var(--border-strong);
      background: #FFFFFF;
      color: var(--text-main);
      font-size: 0.7rem;
      padding: 2px 8px;
      cursor: pointer;
    }
    .timer button:hover {
      border-color: var(--accent);
    }

    .view { display: none; }
    .view.active { display: block; }

    .panel {
      position: relative;
      background: var(--bg-elevated);
      border-radius: 12px;
      border: 1px solid var(--border-strong);
      padding: 12px 14px 14px;
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(0,0,0,0.04);
    }

    label {
      display: block;
      font-size: 0.8rem;
      margin-bottom: 4px;
      color: var(--text-muted);
      font-style: italic;
    }
    select, input[type="text"] {
      width: 100%;
      padding: 7px 9px;
      border-radius: 8px;
      border: 1px solid var(--border-strong);
      background: #FFFFFF;
      color: var(--text-main);
      font-size: 0.9rem;
      margin-bottom: 10px;
    }
    select:focus, input[type="text"]:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(47,49,141,0.15);
    }

    .toggle-row {
      display: flex;
      flex-direction: column;
      gap: 4px;
      margin-top: 4px;
    }
    .toggle-row label {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.78rem;
      color: var(--text-main);
      cursor: pointer;
      font-style: normal;
    }

    .primary-btn {
      margin-top: 8px;
      padding: 7px 14px;
      border-radius: 999px;
      border: 1px solid var(--accent);
      background: var(--accent);
      color: #FFFFFF;
      font-size: 0.82rem;
      cursor: pointer;
    }
    .primary-btn:hover {
      background: #1f256a;
      border-color: #1f256a;
    }

    .hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-bottom: 4px;
      font-style: italic;
    }

    /* Live layout */
    .live-layout {
      display: flex;
      align-items: flex-start;
      gap: 12px;
    }
    .live-main {
      flex: 1 1 auto;
    }

    .live-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }
    .live-header-left {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .live-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--accent);
    }

    .live-mode-toggle {
      display: inline-flex;
      border-radius: 999px;
      border: 1px solid var(--border-strong);
      overflow: hidden;
      background: #F9FAFB;
    }
    .live-mode-toggle button {
      padding: 3px 10px;
      border: none;
      background: transparent;
      color: var(--text-muted);
      font-size: 0.76rem;
      cursor: pointer;
    }
    .live-mode-toggle button.active[data-mode="conversation"] {
      background: var(--accent);
      color: #FFFFFF;
      border-right: 1px solid rgba(255,255,255,0.2);
    }
    .live-mode-toggle button.active[data-mode="voicemail"] {
      background: var(--accent-soft);
      color: #FFFFFF;
    }

    /* Conversation phase tabs */
    .phase-tabs {
      display: inline-flex;
      border-radius: 999px;
      border: 1px solid var(--border-strong);
      overflow: hidden;
      background: #F9FAFB;
      margin-bottom: 6px;
      margin-top: 2px;
    }
    .phase-tab-btn {
      padding: 4px 10px;
      border: none;
      background: transparent;
      font-size: 0.78rem;
      color: var(--text-muted);
      cursor: pointer;
    }
    .phase-tab-btn.active {
      background: var(--accent);
      color: #FFFFFF;
    }

    .phase-section {
      display: none;
      margin-top: 6px;
    }
    .phase-section.active {
      display: block;
    }

    .opener-block {
      margin-top: 2px;
      margin-bottom: 8px;
    }
    .opener-box {
      width: 100%;
      min-height: 120px;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid var(--border-strong);
      background:
        linear-gradient(135deg, rgba(47,49,141,0.05), transparent 55%),
        #FFFFFF;
      font-size: 0.96rem;
      line-height: 1.5;
      color: var(--text-main);
      white-space: pre-wrap;
    }
    .opener-box.active-step {
      border-color: var(--accent-warm);
      box-shadow: 0 0 0 1px rgba(206,159,63,0.35);
    }

    .reaction-section {
      margin-top: 4px;
    }
    .reaction-section.active-step {
      border: 1px solid var(--accent-warm);
      border-radius: 10px;
      padding: 4px 6px 6px;
      background: #FFFBEB;
    }

    .reaction-label {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-main);
    }
    .reaction-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 6px;
      margin-top: 2px;
    }
    .reaction-buttons button {
      padding: 5px 11px;
      border-radius: 999px;
      border: 1px solid var(--border-strong);
      background: #F9FAFB;
      color: var(--text-main);
      font-size: 0.78rem;
      cursor: pointer;
    }
    .reaction-buttons button:hover {
      border-color: var(--accent);
    }
    .reaction-buttons button.active {
      border-color: var(--accent-warm);
      background: #FFF7ED;
      box-shadow: 0 0 0 1px rgba(206,159,63,0.35);
    }

    .response-card {
      margin-top: 2px;
      border-radius: 10px;
      border: 1px solid var(--border-strong);
      background: #FFFFFF;
      padding: 10px 11px;
      min-height: 60px;
      font-size: 0.9rem;
      line-height: 1.4;
      color: var(--text-main);
      box-shadow: 0 8px 24px rgba(0,0,0,0.06);
    }

    .phase-next {
      margin-top: 6px;
      font-size: 0.78rem;
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
    }
    .phase-next-label {
      font-style: italic;
      color: var(--text-muted);
    }
    .phase-next button {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-strong);
      background: #FFFFFF;
      font-size: 0.78rem;
      cursor: pointer;
    }
    .phase-next button:hover {
      border-color: var(--accent-warm);
      background: #FFF7ED;
    }

    /* Presentation and Close sections */
    .phase-notes-title {
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 2px;
      color: var(--text-main);
    }
    .phase-notes-hint {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-style: italic;
      margin-bottom: 4px;
    }
    .phase-notes-area {
      width: 100%;
      min-height: 90px;
      border-radius: 10px;
      border: 1px solid var(--border-strong);
      padding: 8px 9px;
      font-size: 0.9rem;
      resize: vertical;
    }

    .tools-body {
      font-size: 0.8rem;
      color: var(--text-muted);
    }
    .tools-body p { margin: 4px 0; }
    .tools-body ul {
      margin: 4px 0 0;
      padding-left: 16px;
    }
    .tools-body li { margin-bottom: 2px; }

    /* Insights / Discovery view reuse styles */
    .side-panel-section-title {
      font-size: 0.78rem;
      font-weight: 600;
      margin-top: 2px;
      margin-bottom: 2px;
      color: var(--text-main);
    }
    .side-panel-hint {
      font-size: 0.72rem;
      color: var(--text-muted);
      margin-bottom: 3px;
      font-style: italic;
    }
    .side-panel-role-note {
      font-size: 0.78rem;
      color: var(--text-main);
      margin-bottom: 4px;
      padding: 4px 6px;
      border-radius: 8px;
      border: 1px solid var(--border-strong);
      background: #F9FAFF;
    }
    .side-panel-list {
      list-style: decimal;
      padding-left: 16px;
      margin: 4px 0 0;
    }
    .side-panel-list li {
      font-size: 0.78rem;
      margin-bottom: 3px;
      cursor: pointer;
      color: var(--text-main);
    }
    .side-panel-list li.used {
      color: var(--text-muted);
      text-decoration: line-through;
    }
    .insights-textarea {
      width: 100%;
      border-radius: 8px;
      border: 1px solid var(--border-strong);
      background: #FFFFFF;
      color: var(--text-main);
      font-size: 0.8rem;
      padding: 6px 8px;
      resize: vertical;
      min-height: 70px;
      line-height: 1.4;
    }

    @media (max-width: 900px) {
      .live-layout { flex-direction: column; }
    }
    @media (max-width: 720px) {
      .app { padding: 10px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Certatude Call Flow Coach</h1>
      <p><strong>Use this in three steps:</strong> <em>set up before you dial, switch to Live once you connect, then use Insights / Discovery as needed.</em></p>
    </header>

    <div class="tabs">
      <button class="tab active" data-view="setupView">Setup</button>
      <button class="tab" data-view="liveView">Live</button>
      <button class="tab" data-view="toolsView">Tools</button>
      <button class="tab" data-view="insightsView">Insights / Discovery</button>
    </div>

    <div class="timer-bar">
      <div class="timer">
        <span class="timer-display" id="timerDisplay">00:00</span>
        <button id="timerStartPause" type="button">Start</button>
        <button id="timerReset" type="button">Reset</button>
      </div>
    </div>

    <!-- SETUP VIEW -->
    <div id="setupView" class="view active">
      <div class="panel">
        <label for="roleSelect"><strong>Choose who you’re calling</strong> – <em>this shapes angle and questions.</em></label>
        <select id="roleSelect">
          <option value="generic">Generic marketing leader</option>
          <option value="cmo">CMO / SVP Marketing</option>
          <option value="vp" selected>VP / Head of Marketing / Growth</option>
          <option value="ops">Marketing Ops / RevOps</option>
          <option value="demand">Director Demand Gen / Performance</option>
        </select>

        <label for="openerSelect"><strong>Select your opener style</strong> – <em>clarity, ROI, or performance.</em></label>
        <select id="openerSelect">
          <option value="clarity">Option 1 – Clarity / Visibility</option>
          <option value="roi">Option 2 – ROI / Results</option>
          <option value="performance" selected>Option 3 – Performance / Focus</option>
        </select>

        <div class="toggle-row">
          <label><input type="checkbox" id="showAndrew" checked /> Use “Andrew” in script</label>
          <label><input type="checkbox" id="showCompany" checked /> Mention Certatude lightly</label>
        </div>

        <label for="prospectName" style="margin-top:8px;"><strong>Optional:</strong> <em>add prospect name to personalize.</em></label>
        <input type="text" id="prospectName" placeholder="e.g., Claire">

        <label for="companyName"><strong>Optional:</strong> <em>add company name for your own reference.</em></label>
        <input type="text" id="companyName" placeholder="e.g., Acme SaaS">

        <button id="goLiveBtn" class="primary-btn" type="button"><strong>Go to Live mode</strong></button>
      </div>
    </div>

    <!-- LIVE VIEW -->
    <div id="liveView" class="view">
      <div class="live-layout">
        <div class="panel live-main">
          <div class="live-header">
            <div class="live-header-left">
              <div class="live-title">Live</div>
              <div class="live-mode-toggle">
                <button type="button" data-mode="conversation" class="active">Conversation</button>
                <button type="button" data-mode="voicemail">Voicemail</button>
              </div>
            </div>
          </div>

          <!-- Conversation phase tabs -->
          <div id="phaseTabs" class="phase-tabs">
            <button type="button" class="phase-tab-btn active" data-phase="intro">Introduction</button>
            <button type="button" class="phase-tab-btn" data-phase="presentation">Presentation</button>
            <button type="button" class="phase-tab-btn" data-phase="close">Close</button>
          </div>

          <!-- INTRO SECTION -->
          <div id="introSection" class="phase-section active" data-phase="intro">
            <div class="opener-block">
              <div id="openerHint" class="hint"></div>
              <div id="openerBox" class="opener-box"></div>
            </div>

            <div id="reactionSection" class="reaction-section">
              <div class="reaction-label">Select Prospect Reaction</div>
              <div class="reaction-buttons">
                <button type="button" data-reaction="open">Open / curious</button>
                <button type="button" data-reaction="busy">Busy / time-pressed</button>
                <button type="button" data-reaction="fine">“We’re fine / covered”</button>
                <button type="button" data-reaction="notnow">“Not a priority now”</button>
              </div>
              <div id="responseCard" class="response-card"></div>

              <div id="phaseNext" class="phase-next" style="display:none;">
                <span class="phase-next-label">*Based on their answer, choose where to go next.*</span>
                <button type="button" class="phase-next-btn" data-phase-target="presentation">Yes / Interest → Presentation</button>
                <button type="button" class="phase-next-btn" data-phase-target="close">No / Not now → Close</button>
              </div>
            </div>
          </div>

          <!-- PRESENTATION SECTION -->
          <div id="presentationSection" class="phase-section" data-phase="presentation">
            <div class="phase-notes-title">Presentation</div>
            <div class="phase-notes-hint">
              *Summarize what you heard, then connect 1–2 specific outcomes you can help with. Keep it short and concrete.*
            </div>
            <textarea id="presentationNotes" class="phase-notes-area"
              placeholder="We heard X → here’s the 1–2 outcomes we can realistically improve without ripping anything out."></textarea>
          </div>

          <!-- CLOSE SECTION -->
          <div id="closeSection" class="phase-section" data-phase="close">
            <div class="phase-notes-title">Close</div>
            <div class="phase-notes-hint">
              *Confirm fit (or not), propose a next step, and make the &quot;yes&quot; easy. Use their language when you recap.*
            </div>
            <textarea id="closeNotes" class="phase-notes-area"
              placeholder="Recap what you heard in their words, confirm interest, then offer an easy next step (short working session, follow-up with teammate, etc.)."></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- TOOLS VIEW -->
    <div id="toolsView" class="view">
      <div class="panel">
        <div class="tools-body">
          <p><strong>Reference library:</strong> <em>use this tab later to store alternate openers or agency-specific versions.</em></p>
          <p>This area can hold:</p>
          <ul>
            <li>Alternate opener variants (e.g., SaaS, agency, partner-led)</li>
            <li>Additional voicemail patterns</li>
            <li>Personal tweaks you want to re-use</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- INSIGHTS / DISCOVERY VIEW -->
    <div id="insightsView" class="view">
      <div class="panel">
        <div class="side-panel-section-title">Quick reference</div>
        <div class="side-panel-hint">*Use this as your pre-call scratchpad or to regroup mid-call without cluttering Live.*</div>
        <input type="text" id="qrProspectName" class="insights-input" placeholder="Prospect name" />
        <input type="text" id="qrCompanyName" class="insights-input" placeholder="Company" />
        <textarea id="qrQuickNotes" class="insights-textarea"
          placeholder="One or two anchors: e.g., attribution clarity, Q1 pipeline, AI expectations..."></textarea>

        <div class="side-panel-section-title" style="margin-top:8px;">Role angle</div>
        <div id="roleNote" class="side-panel-role-note"></div>

        <div class="side-panel-section-title">Discovery questions</div>
        <div class="side-panel-hint">*Tap a question after you use it to mark it off and avoid repeating yourself.*</div>
        <ol id="followupList" class="side-panel-list"></ol>

        <div class="side-panel-section-title" style="margin-top:8px;">Call notes</div>
        <div class="side-panel-hint">*Capture key phrases in their language for follow-ups and emails.*</div>
        <textarea id="rightNotes" class="insights-textarea"
          placeholder="e.g., 'Biggest pain: no unified view of paid & organic'"></textarea>
      </div>
    </div>
  </div>

  <script>
    // --- DATA ---

    const openers = {
      clarity: `[Prospect], it’s Andrew Apodaca — I know you weren’t expecting my call, I’ll be brief.

I spend a lot of time with marketing teams navigating everything from inconsistent reporting to questions around what’s actually moving the needle.

Rather than guessing, could I ask: how are you approaching visibility and clarity right now inside your marketing org?`,

      roi: `[Prospect], Andrew Apodaca here — I’ll keep this quick.

I spend a lot of time with teams who want higher confidence that their marketing dollars are actually producing the right results — without adding more noise or more tools.

When you think about improving ROI or tightening the connection between marketing and revenue, where do you personally feel the most pressure today?`,

      performance: `[Prospect], Andrew Apodaca here — thanks for taking a second.

I work with marketing leaders who are looking to get sharper on where performance is truly coming from, without adding more complexity.

When you think about improving marketing performance going into next quarter, where are you placing the most focus?`
    };

    const voicemailOpeners = {
      clarity: `Hi [Prospect], it’s Andrew Apodaca calling.

I work with marketing teams on getting a clearer view of what’s actually driving results, especially when attribution and reporting are sending mixed signals.

No need to call back urgently — I’ll also send a quick note with a bit more context. If tightening up visibility around what’s really moving the needle is on your radar, feel free to reply or grab time that works for you.`,

      roi: `Hi [Prospect], it’s Andrew Apodaca.

I work with marketing teams who want stronger clarity on which parts of their marketing mix are actually driving results — without adding more tools or more reporting overhead.

I’ll send a short follow-up note, but if increasing ROI or improving confidence in the numbers is something you’re exploring, feel free to reply or book time that works for you.`,

      performance: `Hi [Prospect], it’s Andrew Apodaca.

I partner with marketing leaders who want a sharper read on where performance is really coming from in their mix — without ripping out what they already have.

I’ll follow up with a short email so you have the details in writing, but if improving confidence in what’s driving pipeline and revenue is something you’re exploring, you can simply reply there or book a brief intro at a time that works for you.`
    };

    const roleNotes = {
      generic: `Keep it neutral. Anchor around clarity, performance, and decision-making support.`,
      cmo: `CMO: tie everything to exec/board visibility, confidence in what’s driving growth, and avoiding extra complexity or headcount.`,
      vp: `VP Marketing / Growth: emphasize campaign performance, pipeline impact, and faster, cleaner calls on where to invest.`,
      ops: `Marketing Ops / RevOps: focus on data alignment across platforms, reporting speed, and trust in the numbers.`,
      demand: `Demand Gen: lean into channel mix, campaign lift, and which levers truly move pipeline and revenue.`
    };

    const reactions = {
      open: `Nice — that’s exactly what I was hoping to learn.

Sounds like this is already on your radar. Just to make this useful for you, where are you finding it hardest right now: getting clean data, agreeing on what to measure, or turning the insights into real decisions?`,

      busy: `Totally fair — I really appreciate you telling me.

How about this: I’ll ask you one quick question now, and if it’s not relevant, we can both bail out. If it *is* relevant, we can find 15 minutes on your terms later. Does that work?`,

      fine: `Good to hear things are working reasonably well.

When teams tell me that, it’s often still because there are one or two areas that feel fuzzy under the surface. If you had to pick one area where you’re “fine but not thrilled” on the analytics or ROI side, what would it be?`,

      notnow: `Totally understand — timing is almost never perfect.

Just so I don’t show up in your inbox with something off-base: when you do look at tightening up your marketing visibility or ROI story, what’s the trigger that usually makes it a priority for you?`
    };

    // Style-specific suggestions for Presentation
    const presentationSnippets = {
      clarity: `“Let me play back what I’m hearing: right now, a lot of the tension is around seeing a clean, unified story across channels — and being confident that what you’re presenting upstairs actually matches what’s happening in the data.

Where we usually help is:
- Pulling paid, owned, and lifecycle touchpoints into a single, trusted view
- Making it easier to answer ‘what’s working / what’s not’ in minutes, not weeks

We’d look at your current stack first and layer better visibility on top of what you already have — no rip-and-replace.”`,

      roi: `“The theme I’m hearing is: you’re investing a lot, but it’s hard to show a crisp line from spend to revenue in a way everyone trusts.

What we typically do is:
- Tighten the link between campaign activity and pipeline / bookings
- Build a small set of ROI views that leadership actually uses to make decisions

The idea wouldn’t be a big platform project — more a focused effort to prove where the money is working hardest and where you can safely pull back.”`,

      performance: `“It sounds like the real question is where performance is *really* coming from — not just which channels look good in isolation.

Where we help is:
- Identifying the 2–3 levers that are truly driving pipeline and revenue
- Showing what happens if you shift budget between those levers

We’d start by pressure-testing what you already believe is working, then show you, with data, where you can lean in or pull back without adding complexity.”`
    };

    // Style-specific suggestions for Close
    const closeSnippets = {
      clarity: `“Based on what you shared, it sounds like clearer, more trusted visibility would be valuable — especially if it doesn’t add more reporting overhead.

A simple next step could be a 20–30 minute working session with you (and whoever owns reporting) where we:
- Look at one or two core reports you rely on today
- Map what’s missing for you to feel ‘board-ready’ on the numbers

If that feels useful, I can send over a couple of times for next week, or you can suggest what works best on your side.”`,

      roi: `“What I’m hearing is that proving ROI — in a way the broader leadership team believes — is still harder than it should be.

A good next step might be a short working session focused on one key initiative or channel, where we:
- Follow the money from spend → pipeline → revenue
- Identify 1–2 places you could either invest more confidently or pull back

If that would be helpful, we can set up 20–30 minutes with you and a key stakeholder, and you can decide from there if it warrants a deeper look.”`,

      performance: `“It sounds like you’re looking for sharper answers on which parts of the mix are *really* driving performance — without adding yet another tool or initiative to manage.

We could start with a focused session where we:
- Take one segment or campaign cluster you care about
- Show how we’d separate signal from noise and highlight the strongest levers

If that feels worthwhile, I’m happy to propose a couple of slots next week, or we can align around what works best on your calendar.”`
    };

    const followUps = [
      `How are you currently tracking marketing performance across your main channels today?`,
      `What’s working well with your stack right now, and what still feels messy or slow when you need answers?`,
      `When you have to explain “what drove this quarter’s results” to leadership, what do you usually rely on?`,
      `Where do you feel the biggest friction today — reporting speed, confidence in the data, or connecting marketing to revenue?`,
      `If you could snap your fingers and improve one part of your visibility or performance story, what would you change first?`
    ];

    // --- ELEMENTS ---
    const tabs = document.querySelectorAll('.tab');
    const views = document.querySelectorAll('.view');

    const roleSelect = document.getElementById('roleSelect');
    const openerSelect = document.getElementById('openerSelect');
    const showAndrew = document.getElementById('showAndrew');
    const showCompany = document.getElementById('showCompany');
    const prospectNameInput = document.getElementById('prospectName');
    const companyNameInput = document.getElementById('companyName');
    const goLiveBtn = document.getElementById('goLiveBtn');

    const openerBox = document.getElementById('openerBox');
    const openerHint = document.getElementById('openerHint');
    const reactionSection = document.getElementById('reactionSection');
    const reactionButtons = document.querySelectorAll('.reaction-buttons button');
    const responseCard = document.getElementById('responseCard');
    const phaseNext = document.getElementById('phaseNext');
    const phaseNextButtons = document.querySelectorAll('.phase-next-btn');

    const phaseTabButtons = document.querySelectorAll('.phase-tab-btn');
    const phaseSections = document.querySelectorAll('.phase-section');
    const presentationNotes = document.getElementById('presentationNotes');
    const closeNotes = document.getElementById('closeNotes');

    const qrProspectName = document.getElementById('qrProspectName');
    const qrCompanyName = document.getElementById('qrCompanyName');
    const qrQuickNotes = document.getElementById('qrQuickNotes');

    const roleNote = document.getElementById('roleNote');
    const followupList = document.getElementById('followupList');

    const modeButtons = document.querySelectorAll('.live-mode-toggle button');

    const timerDisplay = document.getElementById('timerDisplay');
    const timerStartPause = document.getElementById('timerStartPause');
    const timerReset = document.getElementById('timerReset');

    // --- STATE ---
    let currentMode = 'conversation';
    let timerSeconds = 0;
    let timerInterval = null;
    let currentPhase = 'intro';

    // --- VIEW NAVIGATION ---
    function switchView(targetId) {
      views.forEach(v => v.classList.remove('active'));
      document.getElementById(targetId).classList.add('active');
      tabs.forEach(t => t.classList.remove('active'));
      tabs.forEach(t => {
        if (t.dataset.view === targetId) t.classList.add('active');
      });
    }

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const target = tab.dataset.view;
        switchView(target);
      });
    });

    // --- TIMER ---
    function updateTimerDisplay() {
      const mins = String(Math.floor(timerSeconds / 60)).padStart(2, '0');
      const secs = String(timerSeconds % 60).padStart(2, '0');
      timerDisplay.textContent = `${mins}:${secs}`;
    }

    function startTimer() {
      if (timerInterval !== null) return;
      timerInterval = setInterval(() => {
        timerSeconds += 1;
        updateTimerDisplay();
      }, 1000);
      timerStartPause.textContent = 'Pause';
    }

    function pauseTimer() {
      if (timerInterval !== null) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
      timerStartPause.textContent = 'Start';
    }

    function resetTimer() {
      pauseTimer();
      timerSeconds = 0;
      updateTimerDisplay();
    }

    timerStartPause.addEventListener('click', () => {
      if (timerInterval === null) startTimer();
      else pauseTimer();
    });
    timerReset.addEventListener('click', resetTimer);

    // --- PHASE HANDLING ---
    function setPhase(phase) {
      currentPhase = phase;
      phaseTabButtons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.phase === phase);
      });
      phaseSections.forEach(sec => {
        sec.classList.toggle('active', sec.dataset.phase === phase);
      });

      if (currentMode === 'conversation') {
        if (phase === 'intro') {
          setActiveStep('opener');
        } else {
          openerBox.classList.remove('active-step');
          reactionSection.classList.remove('active-step');
        }
      }

      // Auto-suggest for Presentation / Close (only if empty)
      const style = openerSelect.value;
      if (phase === 'presentation' && !presentationNotes.value.trim()) {
        presentationNotes.value = presentationSnippets[style] || '';
      }
      if (phase === 'close' && !closeNotes.value.trim()) {
        closeNotes.value = closeSnippets[style] || '';
      }
    }

    phaseTabButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const phase = btn.dataset.phase;
        setPhase(phase);
      });
    });

    // --- ACTIVE STEP HIGHLIGHT ---
    function setActiveStep(step) {
      openerBox.classList.toggle('active-step', step === 'opener');
      reactionSection.classList.toggle('active-step', step === 'reaction');
    }

    // --- OPENER BUILDING ---
    function getBaseTextForMode() {
      const style = openerSelect.value;
      return currentMode === 'conversation'
        ? openers[style]
        : voicemailOpeners[style];
    }

    function buildOpener() {
      let text = getBaseTextForMode();

      if (!showAndrew.checked) {
        text = text.replace(/Andrew Apodaca/g, 'Andrew');
      }
      if (showCompany.checked) {
        if (!text.includes('Certatude')) {
          text = text.replace(
            'I work with marketing leaders',
            'At Certatude, I work with marketing leaders'
          );
          text = text.replace(
            'I partner with marketing leaders',
            'At Certatude, I partner with marketing leaders'
          );
          text = text.replace(
            'I spend a lot of time with marketing teams',
            'At Certatude, I spend a lot of time with marketing teams'
          );
          text = text.replace(
            'I work with marketing teams',
            'At Certatude, I work with marketing teams'
          );
        }
      } else {
        text = text.replace(/At Certatude, /g, '');
        text = text.replace(/ at Certatude/g, '');
      }

      const prospectName = prospectNameInput.value.trim();
      if (prospectName) {
        text = text.replace(/\[Prospect\]/g, prospectName);
      }

      openerBox.textContent = text;

      if (currentMode === 'conversation') {
        reactionSection.style.display = 'block';
        setPhase('intro');
        setActiveStep('opener');
      } else {
        reactionSection.style.display = 'none';
        phaseTabs.style.display = 'none';
        openerBox.classList.remove('active-step');
      }

      // Update suggested snippets if their fields are still empty
      if (!presentationNotes.value.trim()) {
        presentationNotes.value = presentationSnippets[openerSelect.value] || '';
      }
      if (!closeNotes.value.trim()) {
        closeNotes.value = closeSnippets[openerSelect.value] || '';
      }
    }

    function updateRoleNote() {
      const role = roleSelect.value;
      roleNote.textContent = roleNotes[role] || roleNotes.generic;
    }

    function renderFollowups() {
      followupList.innerHTML = '';
      followUps.forEach((q, idx) => {
        const li = document.createElement('li');
        li.textContent = q;
        li.dataset.index = String(idx);
        li.addEventListener('click', () => {
          li.classList.toggle('used');
        });
        followupList.appendChild(li);
      });
    }

    function clearReactionSelection() {
      reactionButtons.forEach(btn => btn.classList.remove('active'));
      responseCard.textContent = '';
      phaseNext.style.display = 'none';
    }

    const phaseTabs = document.getElementById('phaseTabs');

    // --- SETUP EVENTS ---
    openerSelect.addEventListener('change', () => {
      buildOpener();
      clearReactionSelection();
    });
    showAndrew.addEventListener('change', buildOpener);
    showCompany.addEventListener('change', buildOpener);
    roleSelect.addEventListener('change', updateRoleNote);
    prospectNameInput.addEventListener('input', buildOpener);

    goLiveBtn.addEventListener('click', () => {
      // sync quick ref
      qrProspectName.value = prospectNameInput.value;
      qrCompanyName.value = companyNameInput.value;

      buildOpener();
      updateRoleNote();
      renderFollowups();
      clearReactionSelection();
      resetTimer();
      switchView('liveView');
      setPhase('intro');
    });

    // --- LIVE REACTIONS ---
    reactionButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const key = btn.dataset.reaction;
        reactionButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        responseCard.textContent = reactions[key] || '';
        setActiveStep('reaction');
        phaseNext.style.display = 'flex';
      });
    });

    // Phase next (Yes/No style)
    phaseNextButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const target = btn.dataset.phaseTarget;
        setPhase(target);
      });
    });

    // --- MODE TOGGLE ---
    modeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const mode = btn.dataset.mode;
        if (mode === currentMode) return;
        currentMode = mode;
        modeButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        if (currentMode === 'conversation') {
          phaseTabs.style.display = 'inline-flex';
          buildOpener();
          clearReactionSelection();
          setPhase('intro');
        } else {
          phaseTabs.style.display = 'none';
          reactionSection.style.display = 'none';
          openerHint.textContent = '';
          openerBox.classList.remove('active-step');
          const prospectName = prospectNameInput.value.trim() || '[Prospect]';
          openerBox.textContent = getBaseTextForMode().replace(/\[Prospect\]/g, prospectName);
        }
      });
    });

    // --- INITIAL ---
    updateTimerDisplay();
    clearReactionSelection();
    updateRoleNote();
    renderFollowups();
    buildOpener();
  </script>
</body>
</html>
